/*
 * jquery.urlive.min.js v1.0.3, jQuery URLive
 *
 * View the plugin repository at:
 * https://github.com/markserbol/urlive
 *
 */

(function(a){var k={container:".urlive-container",target:"_blank",imageSize:"auto",render:!0,disableClick:!1,callbacks:{onStart:function(){},onSuccess:function(){},onFail:function(){},noData:function(){},onLoadEnd:function(){},imgError:function(){},onClick:function(){}}},l=function(c){var d=RegExp(location.protocol+"//"+location.hostname),f="http"+(/^https/.test(location.protocol)?"s":"")+"://query.yahooapis.com/v1/public/yql?callback=?";return function(b){var h=b.url;/get/i.test(b.type)&&!/json/i.test(b.dataType)&&!d.test(h)&&/:\/\//.test(h)&&(b.url=f,b.dataType="json",b.data={q:'select * from html where url="{URL}" and xpath="*" and compat="html5"'.replace("{URL}",h+(b.data?(/\?/.test(h)?"&":"?")+a.param(b.data):"")),format:"xml"},!b.success&&b.complete&&(b.success=b.complete,delete b.complete),b.success=function(a){return function(d){a&&a.call(this,{responseText:(d.results[0]||"").replace(/<script[^>]+?\/>|<script(.|\s)*?\/script>/gi,"")},"success")}}(b.success));return c.apply(this,arguments)}}(a.ajax),f=function(){var c=a(this).attr("data-urlive-container")||a(this);return a(c).find(".urlive-link")},g={init:function(c){var d=a.extend(!0,k,c);return this.each(function(){function c(a){if(/\.(?:jpe?g|gif|png)/.test(a)){var d=a.substr(a.lastIndexOf("/")+1);f({image:a,title:d,url:a})}else b(a)}function b(c){l({url:c,type:"GET",beforeSend:d.callbacks.onStart}).done(function(b){b=b.results;a.isEmptyObject(b)?d.callbacks.noData():(b=b[0],html=a("<div/>",{html:b}),get=function(a){return html.find('[property="'+a+'"]').attr("content")||html.find('[name="'+a+'"]').attr("content")||html.find(a).html()||html.find(a).attr("src")},set={image:get("og:image")||get("img"),title:get("og:title")||get("title"),url:get("og:url")||c,description:get("og:description"),type:get("og:type"),sitename:get("og:site_name")},d.callbacks.onSuccess(set),d.render&&f(set))}).fail(function(c,b,e){a.error("YQL request error: ",b,e);d.callbacks.onFail()})}function f(c){anchor=a("<a/>",{"class":"urlive-link",href:c.url,target:d.target});imgWrapper=a("<div/>",{"class":"urlive-img-wrapper"});textWrapper=a("<div/>",{"class":"urlive-text-wrapper"});a.each(c,function(c,b){b&&("image"==c?(img=a("<img/>",{src:b}),img.error(d.callbacks.imgError),img.appendTo(imgWrapper),img.hide().load(function(){var b=a(this).width(),e=a(this).closest(".urlive-link");a(this).addClass("urlive-"+c).show();"auto"==d.imageSize?b>=e.width()?e.addClass("urlive-img-large"):e.addClass("urlive-img-small"):"large"==d.imageSize?e.addClass("urlive-img-large"):"small"==d.imageSize&&e.addClass("urlive-img-small");d.callbacks.onLoadEnd()})):(elem=a("<span/>",{"class":"urlive-"+c,text:b}),elem.appendTo(textWrapper)))});imgWrapper.appendTo(anchor);textWrapper.appendTo(anchor);anchor.appendTo(d.container);anchor.on("click",d.callbacks.onClick);if(d.disableClick)anchor.on("click",function(a){a.preventDefault()})}var e=a(this);e.attr("data-urlive-container",d.container);if(e.is("a"))e=e.attr("href"),c(e);else{var e=e.val()||e.text(),g=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/i;g.test(e)&&(e=g.exec(e)[0],c(e))}})},close:function(a){f.apply(this).fadeOut(a)},remove:function(a){var d=f.apply(this);a?d.fadeOut(a,function(){d.remove()}):d.remove()},open:function(a){f.apply(this).fadeIn(a)},disable:function(){f.apply(this).on("click",function(a){a.preventDefault()})},enable:function(){f.apply(this).off("click")}};a.fn.urlive=function(c){if(g[c])return g[c].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof c&&c)a.error('Method "'+c+'" does not exist on jquery.urlive');else return g.init.apply(this,arguments)}})(jQuery);